<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/cli.js | meeks-prfound-js</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="Tabulate Meek&apos;s method using prfound.org reference rule, with extensions"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="meeks-prfound-js"><meta property="twitter:description" content="Tabulate Meek&apos;s method using prfound.org reference rule, with extensions"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/ballot.js~Ballot.html">Ballot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/decimal9.js~Decimal9.html">Decimal9</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/decimal9.js~Decimal9Error.html">Decimal9Error</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/decimal9.js~Decimal9Total.html">Decimal9Total</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/errors.js~MeekImplementationError.html">MeekImplementationError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/errors.js~MeekValueError.html">MeekValueError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/meek.js~Tabulation.html">Tabulation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/progress.js~Progress.html">Progress</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/results.js~Results.html">Results</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/status.js~Status.html">Status</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/util_basic.js~UtilBaseError.html">UtilBaseError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/util_basic.js~UtilBasicFunctions.html">UtilBasicFunctions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/util_basic.js~UtilValueError.html">UtilValueError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/validate.js~Validator.html">Validator</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/with_json.js~WithJson.html">WithJson</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-tabulate">tabulate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-cliHelper">cliHelper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-K">K</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-UBF">UBF</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/cli.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import {UBF} from &apos;./util_basic.js&apos;;
import cliHelper from &apos;./cli_helper.js&apos;;
import * as Meek from &apos;./meek.js&apos;;

console.debug(&apos;cli.js starting.&apos;);

/*
console.debug(&apos;cli module.parent=&apos;+module.parent);
console.debug(&apos;cliHelper.message=&quot;&apos;+cliHelper.message+&apos;&quot;&apos;);
console.debug(&apos;cli __filename=&quot;&apos;+__filename+&apos;&quot;&apos;);
console.debug(&apos;cli module.filename=&quot;&apos;+module.filename+&apos;&quot;&apos;);
console.debug(&apos;cli require.main.filename=&quot;&apos;+require.main.filename+&apos;&quot;&apos;);
console.debug(&apos;cli arg=&apos;+UBF.show(process.argv));
*/

const candidates = &apos; A B C D E&apos;;
const ballots = [
      [15, &apos; A B C D E&apos;],
      [7,  &apos; B C A E D&apos;],
      &apos; C B A D E&apos;,
      [&apos;C&apos;, &apos;B&apos;, &apos;A&apos;, &apos;D&apos;, &apos;E&apos;],
      [7,  &apos; D E A B C&apos;],
      [9,  &apos; E D C B A&apos;],
      ];
const tie_breaker = &apos; A B C E D&apos;;
const options = {};
const exp_elected = [&apos;A&apos;, &apos;B&apos;, &apos;E&apos;];
/*
const exp_status = _TestAids.buildExpectedStatus([
      [&apos;A&apos;, &apos;elected&apos;, 1, 15.0, 0.556687034],
      [&apos;B&apos;, &apos;elected&apos;,  2, 11.999999995, 0.646687698],
      [&apos;C&apos;, &apos;defeated&apos;, 3, 3.999999987, 0.0],
      [&apos;D&apos;, &apos;defeated&apos;, 4, 9.662674708, 1.0],
      [&apos;E&apos;, &apos;elected&apos;, 4, 10.096395468, 1.0]
      ]);
const exp_tally = _TestAids.buildStvTally({
      &apos;A&apos;: [15.0, 10.000000005, 10.000000005, 10.120464912],
      &apos;B&apos;: [7.0, 11.999999995, 10.000000008, 10.120464912],
      &apos;C&apos;: [2.0, 2.0, 3.999999987],
      &apos;D&apos;: [7.0, 7.0, 7.0, 9.662674708],
      &apos;E&apos;: [9.0, 9.0, 9.0, 10.096395468],
      &apos;:Overvotes&apos;: [0.0, 0.0, 0.0, 0.0],
      &apos;:Abstentions&apos;: [0.0, 0.0, 0.0, 0.0],
      &apos;:Other exhausted&apos;: [0.0, 0.0, 0.0, 0.0],
      &apos;:Votes for candidates&apos;: [40.0, 40.0, 40.0, 40.0],
      &apos;:Total votes&apos;: [40.0, 40.0, 40.0, 40.0],
      &apos;:Quota&apos;: [10.000000001, 10.000000001, 10.000000001, 10.000000001],
      &apos;:Total surplus&apos;: [4.999999999, 1.999999998, 1.1e-08, 0.337325289],
      &apos;:Iterations&apos;: [1, 2, 2, 4]
      });
*/
const expectedStatusesString1 = `
  &quot;status&quot;: [
    [&quot;A&quot;, &quot;elected&quot;, 1, 15.0, 0.556687034],
    [&quot;B&quot;, &quot;elected&quot;, 2, 11.999999995, 0.646687698],
    [&quot;E&quot;, &quot;elected&quot;, 4, 10.096395468, 1.0],
    [&quot;D&quot;, &quot;defeated&quot;, 4, 9.662674708, 1.0],
    [&quot;C&quot;, &quot;defeated&quot;, 3, 3.999999987, 0.0]
  ]`;
const expectedTallyString1 = `
  &quot;tally&quot;: {
    &quot;A&quot;: [15.0, 10.000000005, 10.000000005, 10.120464912],
    &quot;B&quot;: [7.0, 11.999999995, 10.000000008, 10.120464912],
    &quot;E&quot;: [9.0, 9.0, 9.0, 10.096395468],
    &quot;D&quot;: [7.0, 7.0, 7.0, 9.662674708],
    &quot;C&quot;: [2.0, 2.0, 3.999999987],
    &quot;:Votes for candidates&quot;: [40.0, 40.0, 40.0, 40.0],
    &quot;:Overvotes&quot;: [0.0, 0.0, 0.0, 0.0],
    &quot;:Abstentions&quot;: [0.0, 0.0, 0.0, 0.0],
    &quot;:Other exhausted&quot;: [0.0, 0.0, 0.0, 0.0],
    &quot;:Total votes&quot;: [40.0, 40.0, 40.0, 40.0],
    &quot;:Quota&quot;: [10.000000001, 10.000000001, 10.000000001, 10.000000001],
    &quot;:Total surplus&quot;: [4.999999999, 1.999999998, 1.1e-8, 0.337325289],
    &quot;:Iterations&quot;: [1, 2, 2, 4]
  }`;

let tabulator = new Meek.Tabulation(3, candidates, ballots,
      5, tie_breaker, [], [], options);
let results = tabulator.tabulate();
/**/
console.debug(&apos;result elected=&apos;+UBF.show(results.elected));
console.debug(&apos;result statuses=\n&apos;+results.getStatusesAsString());
console.debug(&apos;result tally=\n&apos;+results.getTallyAsString());
console.debug(&apos;result elected &apos;+(
  (UBF.show(results.elected) === 
  &apos;@Set:[&quot;A&quot;, &quot;B&quot;, &quot;E&quot;]&apos;) ?
  &apos;is&apos; :
  &apos;is NOT&apos;
  ) + &apos; expected.&apos;);
console.debug(&apos;result statuses &apos;+(
  (results.getStatusesAsString() === expectedStatusesString1.slice(1)) ?
  &apos;is&apos; :
  &apos;is NOT&apos;
  ) + &apos; expected.&apos;);
console.debug(&apos;result tally &apos;+(
  (results.getTallyAsString() === expectedTallyString1.slice(1)) ?
  &apos;is&apos; :
  &apos;is NOT&apos;
  ) + &apos; expected.&apos;);
/** /
console.debug(&apos;result statuses=&apos;+UBF.show(results.statuses));
console.debug(&apos;result tally=&apos;+UBF.show(results.tally));
//console.debug(&apos;exp_tally=&apos;+UBF.show(exp_tally));
/**/
/** /
expect(new Set(results.elected)).toMatchObject(new Set(exp_elected));
expect(results.statuses).toMatchObject(exp_status);
expect(results.tally).toMatchObject(exp_tally);
/**/ 
console.debug(&apos;cli.js ending.&apos;);

</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
